summary(fit)
TukeyHSD(fit, "group") %>% plot
glht(fit, mcp(group = "Tukey")) %>% summary
glht(fit, mcp(group = "Tukey")) %>% confint
fit.mult <-
glht(fit, mcp(group = "Tukey")) %>% summary %>% .$test %>% {
res <- .$pvalues
names(res) <- names(.$coefficients) %>% gsub(" ", "", .)
res
} %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
windows(3, 2)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult) +
theme_pubr(10, border = T)
ggsave("oneway_ANOVA.pdf")
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 1/0.352777778) +
theme_pubr(10, border = T)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10/0.352777778) +
theme_pubr(10, border = T)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 1/0.352777778) +
theme_pubr(10, border = T)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 1/0.352777778*10) +
theme_pubr(10, border = T)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 2/0.352777778) +
theme_pubr(10, border = T)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10*0.352777778) +
theme_pubr(10, border = T)
summary(fit)
TukeyHSD(fit, "group") %>% plot
glht(fit, mcp(group = "Tukey")) %>% summary
glht(fit, mcp(group = "Tukey")) %>% confint
fit.mult <-
glht(fit, mcp(group = "Tukey")) %>% summary %>% .$test %>% {
res <- .$pvalues
names(res) <- names(.$coefficients) %>% gsub(" ", "", .)
res
} %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
windows(3, 2)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10*0.352777778) +
theme_pubr(10, border = T)
ggsave("oneway_ANOVA.pdf")
d
d[, paste0(y, collapse = " & "), by = group]
d[, paste0(y, collapse = " , "), by = group]
d[, paste0(y, collapse = " & "), by = group]
bartlett.test(y ~ group, d)
oneway.test(y~group, d)
fit <- aov(y ~ group, d)
summary(fit)
fit.mult <-
glht(fit, mcp(group = "Tukey")) %>% summary %>% .$test %>% {
res <- .$pvalues
names(res) <- names(.$coefficients) %>% gsub(" ", "", .)
res
} %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
fit.mult
## oneway ANOVA
set.seed(1523)
d <-
data.table(y = round(c(rep(5, 6), rep(6, 5), rep(7, 7)) + rnorm(18), 2),
group = factor(c(rep("x1", 6), rep("x2", 5), rep("x3", 7))))
tapply(d$y, d$group, shapiro.test)
bartlett.test(y ~ group, d)
d[, paste0(y, collapse = " & "), by = group]
## oneway ANOVA
set.seed(1523)
d <-
data.table(y = round(c(rep(5, 6), rep(6, 5), rep(7, 7)) + rnorm(18), 2),
group = factor(c(rep("x1", 6), rep("x2", 5), rep("x3", 7))))
tapply(d$y, d$group, shapiro.test)
bartlett.test(y ~ group, d)
d[, paste0(y, collapse = " & "), by = group]
fit <- aov(y ~ group, d)
summary(fit)
TukeyHSD(fit, "group") %>% plot
glht(fit, mcp(group = "Tukey")) %>% summary
glht(fit, mcp(group = "Tukey")) %>% confint
fit.mult <-
glht(fit, mcp(group = "Tukey")) %>% summary %>% .$test %>% {
res <- .$pvalues
names(res) <- names(.$coefficients) %>% gsub(" ", "", .)
res
} %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
fit.mult
## oneway ANOVA
set.seed(123)
d <-
data.table(y = round(c(rep(5, 6), rep(6, 5), rep(7, 7)) + rnorm(18), 2),
group = factor(c(rep("x1", 6), rep("x2", 5), rep("x3", 7))))
tapply(d$y, d$group, shapiro.test)
bartlett.test(y ~ group, d)
d[, paste0(y, collapse = " & "), by = group]
fit <- aov(y ~ group, d)
summary(fit)
TukeyHSD(fit, "group") %>% plot
glht(fit, mcp(group = "Tukey")) %>% summary
glht(fit, mcp(group = "Tukey")) %>% confint
fit.mult <-
glht(fit, mcp(group = "Tukey")) %>% summary %>% .$test %>% {
res <- .$pvalues
names(res) <- names(.$coefficients) %>% gsub(" ", "", .)
res
} %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
windows(3, 2)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10*0.352777778) +
theme_pubr(10, border = T)
ggsave("oneway_ANOVA.pdf")
## oneway ANOVA
set.seed(1223463)
d <-
data.table(y = round(c(rep(5, 6), rep(6, 5), rep(7, 7)) + rnorm(18), 2),
group = factor(c(rep("x1", 6), rep("x2", 5), rep("x3", 7))))
tapply(d$y, d$group, shapiro.test)
bartlett.test(y ~ group, d)
d[, paste0(y, collapse = " & "), by = group]
fit <- aov(y ~ group, d)
summary(fit)
TukeyHSD(fit, "group") %>% plot
glht(fit, mcp(group = "Tukey")) %>% summary
glht(fit, mcp(group = "Tukey")) %>% confint
fit.mult <-
glht(fit, mcp(group = "Tukey")) %>% summary %>% .$test %>% {
res <- .$pvalues
names(res) <- names(.$coefficients) %>% gsub(" ", "", .)
res
} %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
windows(3, 2)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10*0.352777778) +
theme_pubr(10, border = T)
ggsave("oneway_ANOVA.pdf")
d <-
data.table(y = round(c(rep(5, 6), rep(6, 5), rep(7, 7)) + rnorm(18), 2),
group = factor(c(rep("x1", 6), rep("x2", 5), rep("x3", 7))))
tapply(d$y, d$group, shapiro.test)
bartlett.test(y ~ group, d)
d[, paste0(y, collapse = " & "), by = group]
fit <- aov(y ~ group, d)
summary(fit)
TukeyHSD(fit, "group") %>% plot
glht(fit, mcp(group = "Tukey")) %>% summary
glht(fit, mcp(group = "Tukey")) %>% confint
fit.mult <-
glht(fit, mcp(group = "Tukey")) %>% summary %>% .$test %>% {
res <- .$pvalues
names(res) <- names(.$coefficients) %>% gsub(" ", "", .)
res
} %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
windows(3, 2)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10*0.352777778) +
theme_pubr(10, border = T)
ggsave("oneway_ANOVA.pdf")
## oneway ANOVA
set.seed(2634)
d <-
data.table(y = round(c(rep(5, 6), rep(6, 5), rep(7, 7)) + rnorm(18), 2),
group = factor(c(rep("x1", 6), rep("x2", 5), rep("x3", 7))))
tapply(d$y, d$group, shapiro.test)
bartlett.test(y ~ group, d)
d[, paste0(y, collapse = " & "), by = group]
fit <- aov(y ~ group, d)
summary(fit)
TukeyHSD(fit, "group") %>% plot
glht(fit, mcp(group = "Tukey")) %>% summary
glht(fit, mcp(group = "Tukey")) %>% confint
fit.mult <-
glht(fit, mcp(group = "Tukey")) %>% summary %>% .$test %>% {
res <- .$pvalues
names(res) <- names(.$coefficients) %>% gsub(" ", "", .)
res
} %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
windows(3, 2)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10*0.352777778) +
theme_pubr(10, border = T)
ggsave("oneway_ANOVA.pdf")
## oneway ANOVA
set.seed(4326)
d <-
data.table(y = round(c(rep(5, 6), rep(6, 5), rep(7, 7)) + rnorm(18), 2),
group = factor(c(rep("x1", 6), rep("x2", 5), rep("x3", 7))))
tapply(d$y, d$group, shapiro.test)
bartlett.test(y ~ group, d)
d[, paste0(y, collapse = " & "), by = group]
fit <- aov(y ~ group, d)
summary(fit)
TukeyHSD(fit, "group") %>% plot
glht(fit, mcp(group = "Tukey")) %>% summary
glht(fit, mcp(group = "Tukey")) %>% confint
fit.mult <-
glht(fit, mcp(group = "Tukey")) %>% summary %>% .$test %>% {
res <- .$pvalues
names(res) <- names(.$coefficients) %>% gsub(" ", "", .)
res
} %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
windows(3, 2)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10*0.352777778) +
theme_pubr(10, border = T)
ggsave("oneway_ANOVA.pdf")
d <-
data.table(y = round(c(rep(5, 6), rep(6, 5), rep(7, 7)) + rnorm(18), 2),
group = factor(c(rep("x1", 6), rep("x2", 5), rep("x3", 7))))
tapply(d$y, d$group, shapiro.test)
bartlett.test(y ~ group, d)
d[, paste0(y, collapse = " & "), by = group]
fit <- aov(y ~ group, d)
summary(fit)
TukeyHSD(fit, "group") %>% plot
glht(fit, mcp(group = "Tukey")) %>% summary
glht(fit, mcp(group = "Tukey")) %>% confint
fit.mult <-
glht(fit, mcp(group = "Tukey")) %>% summary %>% .$test %>% {
res <- .$pvalues
names(res) <- names(.$coefficients) %>% gsub(" ", "", .)
res
} %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
windows(3, 2)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10*0.352777778) +
theme_pubr(10, border = T)
ggsave("oneway_ANOVA.pdf")
## oneway ANOVA
set.seed(364)
d <-
data.table(y = round(c(rep(5, 6), rep(6, 5), rep(7, 7)) + rnorm(18), 2),
group = factor(c(rep("x1", 6), rep("x2", 5), rep("x3", 7))))
tapply(d$y, d$group, shapiro.test)
bartlett.test(y ~ group, d)
d[, paste0(y, collapse = " & "), by = group]
fit <- aov(y ~ group, d)
summary(fit)
TukeyHSD(fit, "group") %>% plot
glht(fit, mcp(group = "Tukey")) %>% summary
glht(fit, mcp(group = "Tukey")) %>% confint
fit.mult <-
glht(fit, mcp(group = "Tukey")) %>% summary %>% .$test %>% {
res <- .$pvalues
names(res) <- names(.$coefficients) %>% gsub(" ", "", .)
res
} %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
windows(3, 2)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10*0.352777778) +
theme_pubr(10, border = T)
ggsave("oneway_ANOVA.pdf")
d[, .(Mean = mean(y)), by = group]
d[, .(Mean = mean(y)), by = group] %>%
xtable
library(lsr)
library(coin)
library(ggpubr)
library(data.table)
library(multcomp)
library(multcompView)
library(xtable)
d[, .(Mean = mean(y)), by = group] %>%
xtable
d[, .(Mean = mean(y)), by = group] %>%
xtable(digits = 2)
d[, .(Mean = mean(y)), by = group] %>%
xtable(digits = 0)
d[, .(Mean = mean(y)), by = group] %>%
xtable(digits = 2)
d[, .(Mean = mean(y)), by = group]
d[, .(Mean = mean(y)), by = group] %>%
xtable(digits = 2, auto = T)
d[, .(Mean = mean(y)), by = group] %>%
as.data.frame %>%
xtable(digits = 2, auto = T)
xalign(precip)
xdigits(mtcars, pad = TRUE)
autoformat(mt)
mt <- xtable(mtcars)
autoformat(mt)
mtcars
d[, .(Mean = mean(y)), by = group]
d[, .(Mean = mean(y)), by = group] %>%
as.data.frame
d[, .(Mean = mean(y)), by = group] %>%
as.data.frame(row.names = "group") %>%
xtable(digits = 2, auto = T)
d[, .(Mean = mean(y)), by = group] %>%
as.data.frame(row.names = "group")
d[, .(Mean = mean(y)), by = group] %>%
as.data.frame(row.names = 1)
d[, .(Mean = mean(y)), by = group] %>%
as.data.frame(row.names = 1:3)
d[, .(Mean = mean(y)), by = group] %>%
as.data.frame(row.names = NA)
d[, .(Mean = mean(y)), by = group] %>%
as.data.frame %>%
set_rownames(.$group)
d[, .(Mean = mean(y)), by = group] %>%
as.data.frame %>%
set_rownames(.$group)
d[, .(Mean = mean(y)), by = group] %>%
as.data.frame %>%
set_rownames(.$group) %>%
xtable(.[, -1], digits = 2, auto = T)
d[, .(Mean = mean(y)), by = group] %>%
as.data.frame %>%
set_rownames(.$group) %>% .[, -1]
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
as.data.frame %>%
set_rownames(.$group) %>%
xtable(.[, -1], digits = 2, auto = T)
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
as.data.frame %>%
# set_rownames(.$group) %>%
xtable(.[, -1], digits = 2, auto = T)
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
as.data.frame %>%
set_rownames(.$group) %>%
xtable(., digits = 2, auto = T)
fit.mult
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
merge(., fit.mult)
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
merge(., fit.mult, by = "group")
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
merge(., fit.mult, by = "group") %>%
as.data.frame
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
merge(., fit.mult, by = "group") %>%
as.data.frame %>%
xtable(., digits = 2, auto = T)
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
merge(., fit.mult, by = "group") %>%
as.data.frame %>%
xtable(., digits = 2, auto = T, label = "fig:oneway_ANOVA", caption = "獨立三樣本的描述性統計。")
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
merge(., fit.mult, by = "group") %>%
as.data.frame %>%
xtable(., digits = 2, auto = T, label = "fig:oneway_ANOVA", caption = "獨立三樣本的描述性統計。")
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
merge(., fit.mult, by = "group") %>%
as.data.frame %>%
.[, c(1:5)]
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
merge(., fit.mult, by = "group") %>%
as.data.frame %>%
.[, c(1:5)] %>%
xtable(., digits = 2, auto = T, label = "fig:oneway_ANOVA", caption = "獨立三樣本的描述性統計。")
tapply(d$y, d$group, shapiro.test)
bartlett.test(y ~ group, d)
fit
fit%>%xtable()
summary(fit)
?TukeyHSD
9.379/(9.379+7.566)
glht(fit, mcp(group = "Tukey")) %>% summary
glht(fit, mcp(group = "Tukey")) %>% summary
TukeyHSD(fit, "group")
glht(fit, mcp(group = "Tukey")) %>% confint
TukeyHSD(fit, "group")
TukeyHSD(fit, "group")$group
TukeyHSD(fit, "group")$group
TukeyHSD(fit, "group")$group[, `p adj`]
TukeyHSD(fit, "group")$group[, `p_adj`]
TukeyHSD(fit, "group")$group %>% str
TukeyHSD(fit, "group")$group[, `p adj`]
TukeyHSD(fit, "group")$group[, "p adj"]
fit.mult <-
TukeyHSD(fit, "group")$group[, "p adj"] %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
fit.mult
fit.mult <-
TukeyHSD(fit, "group")$group[, "p adj"] %>%
multcompLetters %>%
.$Letters %>%
data.table(group = names(.), rank = .) %>%
merge(., d[, .(max.val = max(y)), by = group], by = "group")
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
merge(., fit.mult, by = "group") %>%
as.data.frame %>%
.[, c(1:5)] %>%
xtable(., digits = 2, auto = T, label = "table:oneway_ANOVA", caption = "獨立三樣本的描述性統計。")
windows(3, 2)
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10*0.352777778) +
theme_pubr(10, border = T)
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
merge(., fit.mult, by = "group") %>%
as.data.frame %>%
.[, c(1:5)] %>%
xtable(., digits = 2, auto = T, label = "table:oneway_ANOVA", caption = "獨立三樣本的描述性統計。")
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
as.data.frame
d[, .(Mean = mean(y), SD = sd(y), n = length(y)), by = group] %>%
as.data.frame %>%
xtable(., digits = 2, auto = T, label = "table:oneway_ANOVA", caption = "獨立三樣本的描述性統計。")
TukeyHSD(fit, "group")$group
TukeyHSD(fit, "group")$group %>% xtable
TukeyHSD(fit, "group")$group %T>%
xtable(digits = 2, auto = T, label = "table:oneway_ANOVA", caption = "獨立三樣本的描述性統計。")
TukeyHSD(fit, "group")$group %>%
xtable(digits = 2, auto = T, label = "table:oneway_ANOVA", caption = "獨立三樣本的描述性統計。")
TukeyHSD(fit, "group")$group %>%
xtable(digits = 2, auto = T, label = "table:oneway_ANOVA_post", caption = "獨立三樣本的事後多重比較。")
TukeyHSD(fit, "group")$group %>%
xtable(digits = 3, auto = T, label = "table:oneway_ANOVA_post", caption = "獨立三樣本的事後多重比較。")
ggplot(d, aes(group, y)) +
geom_boxplot(width = 0.2,
outlier.shape = NA) +
geom_jitter(width = 0.3) +
geom_text(aes(group, max.val + 0.5, label = rank), fit.mult, size = 10*0.352777778) +
theme_pubr(10, border = T)
